{% extends "account/base_entrance.html" %}
{% load i18n %}
{% load allauth %}
{% block head_title %}
    Cambiar Contraseña
{% endblock head_title %}

{% block extra_head %}
<style>
.form-group {
    margin-bottom: 1rem;
}
.form-label {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 0.5rem;
    display: block;
}
.form-control {
    border-radius: 8px;
    border: 2px solid #e9ecef;
    padding: 0.75rem;
    font-size: 1rem;
    transition: all 0.3s ease;
}
.form-control:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
}
.text-danger {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
}
</style>
{% endblock %}

{% block content %}
    {% element h1 %}
        {% if token_fail %}
            Token Inválido
        {% else %}
            Cambiar Contraseña
        {% endif %}
    {% endelement %}
    {% if token_fail %}
        {% url 'account_reset_password' as passwd_reset_url %}
        <p>
            El enlace de restablecimiento de contraseña no es válido, posiblemente porque ya ha sido utilizado. Por favor solicita un <a href="{{ passwd_reset_url }}">nuevo restablecimiento de contraseña</a>.
        </p>
    {% else %}
        {% element form method="post" action=action_url %}
            {% slot body %}
                {% csrf_token %}
                <div class="form-group">
                    <label for="{{ form.password1.id_for_label }}" class="form-label">Nueva Contraseña *</label>
                    {{ form.password1 }}
                    {% if form.password1.errors %}
                        <div class="text-danger">
                            {% for error in form.password1.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.password2.id_for_label }}" class="form-label">Confirmar Nueva Contraseña *</label>
                    {{ form.password2 }}
                    {% if form.password2.errors %}
                        <div class="text-danger">
                            {% for error in form.password2.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            {% endslot %}
            {% slot actions %}
                {% element button type="submit" name="action" %}
                    Cambiar Contraseña
                {% endelement %}
            {% endslot %}
        {% endelement %}
    {% endif %}
{% endblock content %}
